diff --git a/foundry/test/BuybackVault.t.sol b/foundry/test/BuybackVault.t.sol
index 61921dd..38290cd 100644
--- a/foundry/test/BuybackVault.t.sol
+++ b/foundry/test/BuybackVault.t.sol
@@ -514,4 +514,44 @@ contract BuybackVaultTest is Test {
         vault.executeBuybackPSM(amount / 2, user, 0, block.timestamp + 1 days);
     }
 
+    // --- A03: rolling window cap ---
+
+    function testExecuteBuybackPSM_WindowCapEnforced() public {
+        // Basis = 1000e18, cap = 10% => 1000 bps
+        _fundStableAsDao(1000e18);
+
+        vm.prank(dao);
+        vault.setBuybackWindowConfig(3600, 1000); // 1h window, 10%
+
+        // 5% used -> ok
+        vm.prank(dao);
+        vault.executeBuybackPSM(50e18, user, 0, block.timestamp + 1);
+
+        // +6% => total 11% -> revert
+        vm.prank(dao);
+        vm.expectRevert(BuybackVault.BUYBACK_TREASURY_WINDOW_CAP_EXCEEDED.selector);
+        vault.executeBuybackPSM(60e18, user, 0, block.timestamp + 1);
+    }
+
+    function testExecuteBuybackPSM_WindowCapResetsAfterDuration() public {
+        _fundStableAsDao(1000e18);
+
+        vm.prank(dao);
+        vault.setBuybackWindowConfig(10, 1000); // 10s window, 10%
+
+        vm.prank(dao);
+        vault.executeBuybackPSM(100e18, user, 0, block.timestamp + 1); // exactly 10% -> ok
+
+        // next within same window would exceed
+        vm.prank(dao);
+        vm.expectRevert(BuybackVault.BUYBACK_TREASURY_WINDOW_CAP_EXCEEDED.selector);
+        vault.executeBuybackPSM(1e18, user, 0, block.timestamp + 1);
+
+        // move past window -> should reset
+        vm.warp(block.timestamp + 11);
+        vm.prank(dao);
+        vault.executeBuybackPSM(1e18, user, 0, block.timestamp + 1); // ok after reset
+    }
+
+
 }
